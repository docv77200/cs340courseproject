<h2>Enrollments</h2>

<table border="1">
  <thead>
    <tr>
      <th>Student</th>
      <th>Section</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {{#each enrollments}}
      <tr>
        <td>{{this.firstName}} {{this.lastName}}</td>
        <td>{{this.courseName}} - Section {{this.sectionNumber}}</td>
        <td>
          <a href="/enrollments/delete?student_id={{this.studentID}}&section_id={{this.sectionID}}"
             onclick="return confirm('Are you sure?')">Delete</a>

          <form method="POST" action="/enrollments/update" style="margin-top: 10px;">
            <input type="hidden" name="enrollment_id" value="{{this.enrollmentID}}" />

            <select name="student_id">
              {{#each ../students}}
                <option value="{{this.studentID}}" {{#ifCond this.studentID '==' ../studentID}}selected{{/ifCond}}>
                  {{this.name}}
                </option>
              {{/each}}
            </select>

            <select name="section_id">
              {{#each ../sections}}
                <option value="{{this.section_id}}" {{#ifCond this.section_id '==' ../sectionID}}selected{{/ifCond}}>
                  {{this.label}}
                </option>
              {{/each}}
            </select>

            <button type="submit">Update</button>
          </form>
        </td>
      </tr>
    {{/each}}
  </tbody>
</table>

<h3>Add Enrollment</h3>
<form method="POST" action="/enrollments/add">
  <label for="student_id">Student:</label>
  <select name="student_id" required>
    {{#each students}}
      <option value="{{this.studentID}}">{{this.name}}</option>
    {{/each}}
  </select>

  <label for="section_id">Section:</label>
  <select name="section_id" required>
    {{#each sections}}
      <option value="{{this.section_id}}">{{this.label}}</option>
    {{/each}}
  </select>

  <button type="submit">Enroll</button>
</form>
